training.compare=TurkeyHSD(training.aov)
#conduct Turkey's HSD test
training.compare=TukeyHSD(training.aov)
training.compare
#plot 95$ Cls
plot(TurkeyHSD(training.aov))
#plot 95$ Cls
plot(TukeyHSD(training.aov))
#make a boxplot
boxplot(money~training, data=df)
ToothGrowth
##Two-Way ANOVA
with(ToothGrowth, tapply(len,list(supp,dose),mean))
#Test of significance
ToothGrowth.aov = aov(len~supp*dose, data=ToothGrowth)
summary(TOothGrowth.aov)
summary(ToothGrowth.aov)
#Draw a boxplot
boxplot(len~supp*dose, data=ToothGrowth)
boxplot(len~supp*dose, data=ToothGrowth,
col=c("deepwink","yellowgreen"), las=1,
xlab="Vitamin C Type",
ylab="Tooth Growth",
main="Effects of Vitamin C on Tooth Growh")
boxplot(len~supp*dose, data=ToothGrowth,
col=c("deeppink","yellowgreen"), las=1,
xlab="Vitamin C Type",
ylab="Tooth Growth",
main="Effects of Vitamin C on Tooth Growh")
#Draw a line graph
interaction.plot(x.factor=ToothGrowth$dose,
trace.factor=ToothGrowth$supp,
resposne=ToothGrowth$len,
las=1, type="b",phc=c(1,19),col=c('blue','red'),
trace.labe="Supplement",
xlab="Dose Level", ylab="Tooth Length",
main="Interaction Plot for Tooth Growth")
#Draw a line graph
interaction.plot(x.factor=ToothGrowth$dose,
trace.factor=ToothGrowth$supp,
resposne=ToothGrowth$len,
las=1, type="b",phc=c(1,19),col=c('blue','red'),
trace.label="Supplement",
xlab="Dose Level", ylab="Tooth Length",
main="Interaction Plot for Tooth Growth")
#Draw a line graph
interaction.plot(x.factor=ToothGrowth$dose,
trace.factor=ToothGrowth$supp,
response=ToothGrowth$len,
las=1, type="b",phc=c(1,19),col=c('blue','red'),
trace.label="Supplement",
xlab="Dose Level", ylab="Tooth Length",
main="Interaction Plot for Tooth Growth")
Salaries <- read.csv("C:/Users/eunju/Desktop/junior/TT13.30 BusinessAnalytics/assignment/Salaries.csv")
View(Salaries)
#import dataset
df= Salaries
df.aov= aov(salary~discipline*sex, data=df)
summary(df.aov)
#boxplot
boxplot(salary~discipline*sex, data=df)
#interaction
interaction(x.factor=df$sex, trace.factor=df$discipline,
response=df$salary)
#interaction
interaction.plot(x.factor=df$sex, trace.factor=df$discipline,
response=df$salary)
with(df, tapply(salary,list(discipline,sex),mean))
#boxplot
boxplot(salary~discipline*sex, data=df,
col=c("red","blue"),
xlab="gender",ylab="salary",
main="Effects of gender on salary")
#boxplot
boxplot(salary~discipline*sex, data=df,
col=c("red","blue"),las=1,
xlab="gender",ylab="salary",
main="Effects of gender on salary")
#boxplot
boxplot(salary~discipline*sex, data=df,
col=c("red","blue"),las=1,
xlab="discipline",ylab="salary",
main="Effects of discipline on salary")
training <- read.delim("C:/Users/eunju/Desktop/junior/TT13.30 BusinessAnalytics/training.txt")
View(training)
##사후분석
df=training
##Two-Way ANOVA
#Examine the means
with(ToothGrowth, tapply(len,list(supp,dose),mean))
#Test of significance
ToothGrowth.aov = aov(len~supp*dose, data=ToothGrowth)
summary(ToothGrowth.aov)
boxplot(len~supp*dose, data=ToothGrowth,
col=c("deeppink","yellowgreen"), las=1,
xlab="Vitamin C Type",
ylab="Tooth Growth",
main="Effects of Vitamin C on Tooth Growh")
#import dataset
df= Salaries
df.aov= aov(salary~discipline*sex, data=df)
summary(df.aov)
#boxplot
boxplot(salary~discipline*sex, data=df,
col=c("whitered","whiteblue"),las=1,
xlab="discipline",ylab="salary",
main="Effects of discipline on salary")
#boxplot
boxplot(salary~discipline*sex, data=df,
col=c("red","whiteblue"),las=1,
xlab="discipline",ylab="salary",
main="Effects of discipline on salary")
#boxplot
boxplot(salary~discipline*sex, data=df,
col=c("red","blue"),las=1,
xlab="discipline",ylab="salary",
main="Effects of discipline on salary")
#boxplot
boxplot(salary~discipline*sex, data=df,
col=c("red","blue"),
xlab="discipline",ylab="salary",
main="Effects of discipline on salary")
#boxplot
boxplot(salary~discipline*sex, data=df,
col=c("red","blue"), las=1,
xlab="discipline",ylab="salary",
main="Effects of discipline on salary")
#boxplot
boxplot(salary~discipline*sex, data=df,
col=c("red","blue"),
xlab="discipline",ylab="salary",
main="Effects of discipline on salary")
#boxplot
boxplot(salary~discipline*sex, data=df,
col=c("red","blue"), las=1
xlab="discipline",ylab="salary",
main="Effects of discipline on salary")
#boxplot
boxplot(salary~discipline*sex, data=df,
col=c("red","blue"), las=1
xlab="discipline",ylab="salary",
main="Effects of discipline on salary")
#boxplot
boxplot(salary~discipline*sex, data=df,
col=c("red","blue"), las=1,
xlab="discipline",ylab="salary",
main="Effects of discipline on salary")
#interaction
interaction.plot(x.factor=df$sex, trace.factor=df$discipline,
response=df$salary,
las=1, type="b", col=c('red','blue'),
trace.label="discipline", xlab="gender", ylab="salary",
main="Interaction Plot for salary")
#Draw a line graph
interaction.plot(x.factor=ToothGrowth$dose,
trace.factor=ToothGrowth$supp,
response=ToothGrowth$len,
las=1, type="b",phc=c(1,19),col=c('blue','red'),
trace.label="Supplement",
xlab="Dose Level", ylab="Tooth Length",
main="Interaction Plot for Tooth Growth")
#interaction
interaction.plot(x.factor=df$sex, trace.factor=df$discipline,
response=df$salary,
las=1, type="b", col=c('red','blue'),
trace.label="discipline", xlab="gender", ylab="salary",
main="Interaction Plot for salary")
#interaction
interaction.plot(x.factor=df$sex, trace.factor=df$discipline,
response=df$salary,
las=1, type="b", col=c('red','blue'),pch=c(1,19)
trace.label="discipline", xlab="gender", ylab="salary",
main="Interaction Plot for salary")
#interaction
interaction.plot(x.factor=df$sex, trace.factor=df$discipline,
response=df$salary,
las=1, type="b", col=c('red','blue'),pch=c(1,19),
trace.label="discipline", xlab="gender", ylab="salary",
main="Interaction Plot for salary")
#interaction
interaction.plot(x.factor=df$sex, trace.factor=df$discipline,
response=df$salary,
las=1, type="b", col=c('red','blue'),
trace.label="discipline", xlab="gender", ylab="salary",
main="Interaction Plot for salary")
#interaction
interaction.plot(x.factor=df$sex, trace.factor=df$discipline,
response=df$salary,
las=1, type="b", col=c('red','blue'),pch=c(1,19),
trace.label="discipline", xlab="gender", ylab="salary",
main="Interaction Plot for salary")
#interaction
interaction.plot(x.factor=df$sex, trace.factor=df$discipline,
response=df$salary,
las=1, type="b", col=c('red','blue'),
trace.label="discipline", xlab="gender", ylab="salary",
main="Interaction Plot for salary")
#interaction
interaction.plot(x.factor=df$sex, trace.factor=df$discipline,
response=df$salary,
las=1, type="b", col=c('red','blue'),pch=c(1,19),
trace.label="discipline", xlab="gender", ylab="salary",
main="Interaction Plot for salary")
#interaction
interaction.plot(x.factor=df$sex, trace.factor=df$discipline,
response=df$salary,
las=1, type="b", col=c('red','blue'),pch=c(24,19),
trace.label="discipline", xlab="gender", ylab="salary",
main="Interaction Plot for salary")
#interaction
interaction.plot(x.factor=df$sex, trace.factor=df$discipline,
response=df$salary,
las=1, type="b", col=c('red','blue'),pch=c(21,19),
trace.label="discipline", xlab="gender", ylab="salary",
main="Interaction Plot for salary")
#interaction
interaction.plot(x.factor=df$sex, trace.factor=df$discipline,
response=df$salary,
las=1, type="b", col=c('red','blue'),pch=c(1,19),
trace.label="discipline", xlab="gender", ylab="salary",
main="Interaction Plot for salary")
#interaction
interaction.plot(x.factor=df$sex, trace.factor=df$discipline,
response=df$salary,
las=1, type="b", col=c('red','blue'),pch=c(1,19),
trace.label="discipline", xlab="gender", ylab="salary",
main="Interaction Plot for salary")
#interaction
interaction.plot(x.factor=df$sex, trace.factor=df$discipline,
response=df$salary,
las=1, type="b", col=c('red','blue'),pch=c(21,19),
trace.label="discipline", xlab="gender", ylab="salary",
main="Interaction Plot for salary")
#interaction
interaction.plot(x.factor=df$sex, trace.factor=df$discipline,
response=df$salary,
las=1, type="b", col=c('red','blue'),pch=c(1,2),
trace.label="discipline", xlab="gender", ylab="salary",
main="Interaction Plot for salary")
#interaction
interaction.plot(x.factor=df$sex, trace.factor=df$discipline,
response=df$salary,
las=1, type="b", col=c('red','blue'),pch=c(1,5),
trace.label="discipline", xlab="gender", ylab="salary",
main="Interaction Plot for salary")
#interaction
interaction.plot(x.factor=df$sex, trace.factor=df$discipline,
response=df$salary,
las=1, type="b", col=c('red','blue'),pch=c(1,19),
trace.label="discipline", xlab="gender", ylab="salary",
main="Interaction Plot for salary")
#interaction
interaction.plot(x.factor=df$sex, trace.factor=df$discipline,
response=df$salary,
las=1, type="b", col=c('red','blue'),pch=c(19,19),
trace.label="discipline", xlab="gender", ylab="salary",
main="Interaction Plot for salary")
df.aov= aov(salary~discipline*sex, data=df)
summary(df.aov)
#import dataset
df= Salaries
df.aov= aov(salary~discipline*sex, data=df)
summary(df.aov)
#boxplot
boxplot(salary~discipline*sex, data=df,
col=c("red","blue"), las=1,
xlab="discipline",ylab="salary",
main="Effects of discipline on salary")
#boxplot
boxplot(salary~discipline*sex, data=df,
col=c("red","blue"), las=1,
xlab="discipline",ylab="salary",
main="Effects of discipline on salary")
Salaries <- read.csv("C:/Users/eunju/Desktop/junior/TT13.30 BusinessAnalytics/assignment/Salaries.csv")
View(Salaries)
#import dataset
df= Salaries
df.aov= aov(salary~discipline*sex, data=df)
summary(df.aov)
#boxplot
boxplot(salary~discipline*sex, data=df,
col=c("red","blue"), las=1,
xlab="discipline",ylab="salary",
main="Effects of discipline on salary")
#boxplot
boxplot(salary~discipline*sex, data=df,
col=c("red","blue"), las=1,
xlab="discipline",ylab="salary",
main="Effects of discipline on salary")
#interaction
interaction.plot(x.factor=df$sex, trace.factor=df$discipline,
response=df$salary,
las=1, type="b", col=c('red','blue'),pch=c(19,19),
trace.label="discipline", xlab="gender", ylab="salary",
main="Interaction Plot for salary")
Salaries <- read.csv("C:/Users/eunju/Desktop/junior/TT13.30 BusinessAnalytics/assignment/Salaries.csv")
View(Salaries)
#import dataset
df= Salaries
df.aov= aov(salary~discipline*sex, data=df)
summary(df.aov)
#boxplot
boxplot(salary~discipline*sex, data=df,
col=c("red","blue"), las=1,
xlab="discipline",ylab="salary",
main="Effects of discipline on salary")
#boxplot
boxplot(salary~discipline, data=df,
col=c("red","blue"), las=1,
xlab="discipline",ylab="salary",
main="Effects of discipline on salary")
library(MASS)
plot(cats$Hwt ~ cats$Bwt,
col= 'forestgreen', pch=19,
xlab= "Body Weight (kg)", ylab= "Heart Weight (g)",
main= "Body weight and Heart Weight of Cats")
#how to conduct
x=c(1,3,5,5,6)
xmean= mean(x)
xmean
#how to conduct
X= c(1,3,5,5,6)
Xmean= mean(X)
x= X-Xmean
x
Y= c(4,6,10,12,13,45,9)
Ymean= mean(Y)
y= Y-Ymean
y
Y= c(4,6,10,12,13)
Ymean= mean(Y)
y= Y-Ymean
y
xy= x*y
xy
Hitters <- read.csv("C:/Users/eunju/Desktop/junior/TT13.30 BusinessAnalytics/Hitters.csv")
View(Hitters)
#Import dataset
df= Hitters
#conduct linear regression
hmrun.lm = lm(Salary~HmRun, data=df)
summary(hmrun.lm)
#draw a scatter plot with regression line
plot(df$Salary~df$HmRun,
col="cornflowerblue", pch=19,
xlab="Number of Home Runs", ylab="Salary dollars",
main="Home Runs and Salary")
abline(hmrun.lm, col="salmon", lwd=2)
## [r-code 1.6.1 BVNpdf.R] ##
BVNpdf <- function(mu1,mu2,sig1,sig2,rho) {
par(mfrow=c(1,2))
s12 = sig1*sig2*rho
s11 = sig1^2
s22 = sig2^2
Sig <- matrix(c(s11,s12,s12,s22),ncol=2,nrow=2,byrow=T)
Sinv <- solve(Sig)
x1 <- seq(mu1 - 3.5*sig1,mu1+3.5*sig1,len=50)
fx1 <- seq(-3.5,3.5,len=50)
x2 <- seq(mu2 - 3.5*sig2,mu2+3.5*sig2,len=50)
fx2 <- seq(-3.5,3.5,len=50)
f <- function(x1,x2) {
cons <- ((2*pi)*det(Sig)^.5)^{-1}
cons*exp(-(.5*(1 - rho^2)^{-1})*(x1^2+x2^2-2*rho*x1*x2))
}
f <- outer(fx1,fx2,f)
persp(x1,x2,f,theta = 30, expand=.50)
title(main="Bivariate Normal pdf")
contour(x1,x2,f,lty="solid",drawlabels=F)
title(main="Contour Plot of BVN pdf")
}
BVNpdf(0,0,1,1,0)
BVNpdf(0,0,1,1,0.8)
BVNpdf(0,0,1,1,-0.8)
BVNpdf(0,0,1,1,0)
## [r-code 1.8.1 iris-chisqplot.R] ##
data(iris)
setosa = iris[1:50, 1:4]  # Iris data only for setosa
# Chi-squre Plot for Checking MVN / 카이제곱을 통한 다변량 검정
x=setosa
n=dim(x)[1]
p=dim(x)[2]
S=cov(x)
xbar=colMeans(x)
m=mahalanobis(x, xbar, S)
m=sort(m)
id=seq(1, n)
pt=(id-0.5)/n
q=qchisq(pt, p)
plot(q, m, pch="*", xlab="Quantile", ylab="Ordered Squared Distance")
abline(0, 1)
## [r-code 1.8.2 iris-MVNtest.R] ##
library("MVN") # for mardia test
install.packages("MVN")
versicolor = iris[51:100, 1:4]
#x=versicolor
x=versicolor
n=dim(x)[1]
p=dim(x)[2]
S=cov(x)
xbar=colMeans(x)
m=mahalanobis(x, xbar, S)
m=sort(m)
id=seq(1, n)
pt=(id-0.5)/n
q=qchisq(pt, p)
plot(q, m, pch="*", xlab="Quantile", ylab="Ordered Squared Distance")
abline(0, 1)
# Correlation Coefficient Test for Normailty
rq=cor(cbind(q, m))[1,2]
rq
iris
# MVN tests based on the Skewness and Kurtosis Ststistics
setosa = iris[1:50, 1:4] # Iris data only for setosa and four variables
versicolor = iris[51:100, 1:4] # Iris data only for versicolor and four variables
virginica = iris[101:150, 1:4] # Iris data only for virginica and four variables
par(mfrow=c(1,3))
result_setosa = mvn(setosa, mvnTest = "mardia", multivariatePlot =  "qq")
## [r-code 1.8.2 iris-MVNtest.R] ##
library("MVN") # for mardia test
par(mfrow=c(1,3))
result_setosa = mvn(setosa, mvnTest = "mardia", multivariatePlot =  "qq")
result_versicolor = mvn(versicolor, mvnTest = "mardia", multivariatePlot =  "qq")
result_virginica = mvn(virginica, mvnTest = "mardia", multivariatePlot =  "qq")
result_setosa
result_versicolor
result_virginica
Data1.3.4<-read.table("C:\\Users\\eunju\\Desktop\\junior\\TT10.30 다변량통계학\\Middle_Examination\\irisflower.txt", header=T)
Y<-Data1.3.4[, -1]
class(Y)
Ysetosa<-Y[1:50,c(1,3)] #군집1 (setosa)
Yvervir<-Y[51:150,c(1,3)] #군집2 (versicolor, virginica)
head(Ysetosa)
head(Yvervir) #versicolor와 virginica가 한 그룹에 묶어져 있어서 데이터 묶음
Ysetosa<-as.matrix(Ysetosa)
n<-nrow(Ysetosa)
ybarset<-t(Ysetosa)%*%matrix(1,n,1)/n
Sset<-cov(Ysetosa)
Rset<-cor(Ysetosa)
ybarset
Sset
Rset
Yvervir<-as.matrix(Yvervir)
n<-nrow(Yvervir)
ybarvervir<-t(Yvervir)%*%matrix(1,n,1)/n
Svervir<-cov(Yvervir)
Rvervir<-cor(Yvervir)
ybarvervir
Svervir
Rvervir
BVNpdf <- function(mu1,mu2,sig1,sig2,rho) { #BVN함수
par(mfrow=c(1,2))
s12 = sig1*sig2*rho
s11 = sig1^2
s22 = sig2^2
Sig <- matrix(c(s11,s12,s12,s22),ncol=2,nrow=2,byrow=T)
Sinv <- solve(Sig)
x1 <- seq(mu1 - 3.5*sig1,mu1+3.5*sig1,len=50)
fx1 <- seq(-3.5,3.5,len=50)
x2 <- seq(mu2 - 3.5*sig2,mu2+3.5*sig2,len=50)
fx2 <- seq(-3.5,3.5,len=50)
f <- function(x1,x2) {
cons <- ((2*pi)*det(Sig)^.5)^{-1}
cons*exp(-(.5*(1 - rho^2)^{-1})*(x1^2+x2^2-2*rho*x1*x2))
}
f <- outer(fx1,fx2,f)
persp(x1,x2,f,theta = 30, expand=.50)
title(main="Bivariate Normal pdf")
contour(x1,x2,f,lty="solid",drawlabels=F)
title(main="Contour Plot of BVN pdf")
}
BVNpdf(ybarset[1,1],ybarset[2,1],sqrt(Sset[1,1]),sqrt(Sset[2,2]),Rset[1,2])
BVNpdf(ybarvervir[1,1],ybarvervir[2,1],sqrt(Svervir[1,1]),sqrt(Svervir[2,2]),Rvervir[1,2])
##0505
mouse.data = data.frame(
size = c(1.4, 2.6, 1.0, 3.7, 5.5, 3.2, 3.0, 4.9, 6.3),
weight = c(0.9, 1.8, 2.4, 3.5, 3.9, 4.4, 5.1, 5.6, 6.3),
tail = c(0.7, 1.3, 0.7, 2.0, 3.6, 3.0, 2.9, 3.9, 4.0))
mouse.data
mtcars
#example
state.x77
setwd("C:\\Users\\eunju\\Desktop\\3학년 2학기\\공모전_2020년 통계데이터 분석활용대회\\확정_제조업 실적,전망\\생산능력지수")
data= read.csv("생산능력지수.csv")
library(dygraphs)
library(xts)
data[,1]<-as.Date(data[,1])
str(data)
dyg= xts(data[,2:31], order.by=data[,1])
data[,1]<-as.Date(data[,1])
dyg= xts(data[,2:31], order.by=data[,1])
dyg= xts(data[,2:22], order.by=data[,1])
dygraph(dyg)%>%
dyLegend(show = "follow") %>%
dyAxis("y",valueRange = c(0,550))
dygraph(dyg)%>%
dyLegend(show = "follow") %>%
dyAxis("y",valueRange = c(50,150))
dygraph(dyg)%>%
dyLegend(show = "follow") %>%
dyAxis("y",valueRange = c(50,151))
dygraph(dyg)%>%
dyLegend(show = "follow") %>%
dyAxis("y",valueRange = c(40,161))
setwd("C:\\Users\\eunju\\Desktop\\3학년 2학기\\공모전_2020년 통계데이터 분석활용대회\\확정_제조업 실적,전망\\생산능력지수")
data= read.csv("생산능력지수.csv")
library(dygraphs)
library(xts)
data[,1]<-as.Date(data[,1])
dyg= xts(data[,2:22], order.by=data[,1])
dygraph(dyg)%>%
dyLegend(show = "follow") %>%
dyAxis("y",valueRange = c(40,161))
